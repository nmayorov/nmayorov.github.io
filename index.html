<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.140.1"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Navigating Uncertainty</title>
<meta name=description content><meta name=author content="Nikolay Mayorov"><link rel=canonical href=https://nmayorov.github.io/><link crossorigin=anonymous href=/assets/css/stylesheet.2bf60e0c06fa2260ec89bda82b16e279786ebbefb017df7d2d7785db558ea2c7.css integrity="sha256-K/YODAb6ImDsib2oKxbieXhuu++wF999LXeF21WOosc=" rel="preload stylesheet" as=style><link rel=icon href=https://nmayorov.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nmayorov.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nmayorov.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://nmayorov.github.io/apple-touch-icon.png><link rel=mask-icon href=https://nmayorov.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://nmayorov.github.io/index.xml><link rel=alternate hreflang=en href=https://nmayorov.github.io/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script><meta property="og:url" content="https://nmayorov.github.io/"><meta property="og:site_name" content="Navigating Uncertainty"><meta property="og:title" content="Navigating Uncertainty"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Navigating Uncertainty"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Navigating Uncertainty","url":"https://nmayorov.github.io/","description":"","logo":"https://nmayorov.github.io/favicon.ico","sameAs":["https://github.com/nmayorov","mailto:nikolay.mayorov@zoho.com","https://t.me/nmayorov"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nmayorov.github.io/ accesskey=h title="Navigating Uncertainty (Alt + H)">Navigating Uncertainty</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nmayorov.github.io/open_source title="Open source"><span>Open source</span></a></li><li><a href=https://nmayorov.github.io/archives title="All posts"><span>All posts</span></a></li><li><a href=https://nmayorov.github.io/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>About this blog</h1></header><div class=entry-content><ul><li><p>Hi! I&rsquo;m Nikolay Mayorov &ndash; a software developer with an emphasis on math, algorithms and numerical methods.</p></li><li></li><li><p>My main areas of expertise are &ldquo;classical&rdquo; navigation and applied estimation theory.
These include things like basic inertial and satellite navigation, tight INS/GNSS integration, Real Time Kinematics positioning, Kalman filters, nonlinear least squares and optimization in dynamic systems.
In general I strive to build practical algorithms and systems which solve real life problems based on rigorous mathematical foundations.</p></li><li></li><li><p>The notes here are on theoretical and applied aspects of estimation and navigation algorithms: some classical and some not, which I&rsquo;m figuring out for myself.
Currently there is hardly any code provided as I focus more on underlying concepts, but this approach might change in the future.</p></li><li></li><li><p>For questions or proposals contact me via the links below.</p></li></ul></div><footer class=entry-footer><div class=social-icons><a href=https://github.com/nmayorov target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=mailto:nikolay.mayorov@zoho.com target=_blank rel="noopener noreferrer me" title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a><a href=https://t.me/nmayorov target=_blank rel="noopener noreferrer me" title=Telegram><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.198 2.433a2.242 2.242.0 00-1.022.215l-8.609 3.33c-2.068.8-4.133 1.598-5.724 2.21a405.15 405.15.0 01-2.849 1.09c-.42.147-.99.332-1.473.901-.728.968.193 1.798.919 2.286 1.61.516 3.275 1.009 4.654 1.472.509 1.793.997 3.592 1.48 5.388.16.36.506.494.864.498l-.002.018s.281.028.555-.038a2.1 2.1.0 00.933-.517c.345-.324 1.28-1.244 1.811-1.764l3.999 2.952.032.018s.442.311 1.09.355c.324.022.75-.04 1.116-.308.37-.27.613-.702.728-1.196.342-1.492 2.61-12.285 2.997-14.072l-.01.042c.27-1.006.17-1.928-.455-2.474a1.654 1.654.0 00-1.034-.407z"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Rigorous consideration of noisy control input in Kalman filter state propagation</h2></header><div class=entry-content><p>In a previous post I’ve considered an intuitive engineering approach of handling noisy control input signals in Extended Kalman Filters. Here I want to develop a more rigorous view to this approach.
Problem formulation Let’s consider a linear state transition equation for $x_k$ of the form: $$ x_{k + 1} = F_k x_k + B_k u_k, $$ where $u_k$ is the deterministic sequence of control vectors. Initial distribution of $x$ is given as normal: $$ x_0 \sim \mathcal{N}(\hat{x}_0, P_0) $$
...</p></div><footer class=entry-footer><span title='2024-12-20 00:00:00 +0000 UTC'>December 20, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Rigorous consideration of noisy control input in Kalman filter state propagation" href=https://nmayorov.github.io/posts/noisy_control_derivation/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Strapdown IMU synthesis</h2></header><div class=entry-content><p>Synthesis of strapdown Inertial Measurement Unit (IMU) readings is required for simulation of inertial navigation systems and related algorithms development. Here I want to describe the algorithm of IMU synthesis implemented in pyins, which is probably one of the most useful functions in the library.
Problem formulation The task is to compute strapdown IMU readings from a time series of position and attitude. The following points define the algorithm requirements:
Data is provided at known time points $t_k$, not necessary equispaced Position is given as a time series of latitude, longitude and altitude – $\varphi(t_k), \lambda(t_k), h(t_k)$ Attitude is given as a time series of roll, pitch and heading angles – $\gamma(t_k), \theta(t_k), \psi(t_k)$ The algorithm must account for Earth rotation and ellipticity and use realistic gravity model The algorithm must be able to compute rate and increment (integral) readings Preliminarily considerations We want to generate IMU from sampled trajectory points instead of some predefined continuous functions to have more flexibility and convenience. Figuring out and implementing appropriate continuous functions for position and attitude is difficult task on its own, which is better to be avoided.
...</p></div><footer class=entry-footer><span title='2024-03-03 00:00:00 +0000 UTC'>March 3, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Strapdown IMU synthesis" href=https://nmayorov.github.io/posts/imu_synthesis/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Robust Extended Kalman Filter update. Part 2: comparison with outlier rejection approach</h2></header><div class=entry-content><p>Here I compare properties of the robust EKF update algorithm with a classical outlier rejection approach based on normalized innovation checks.
Outlier rejection approach A well known and efficient approach in Kalman filtering is analyzing whether normalized measurement innovations are reasonable. The innovation $$ e = z - H x^- $$ has theoretical covariance $$ S = H P^- H^T + R $$ The quadratic form $e^T S^{-1} e$ is expected to have a $\chi$-squared distribution and its excessively large values indicate a possible outlier, which should be rejected. For scalar measurements it is equivalent to rejection measurements when the innovation is larger than (for example) 3$\sigma$ with $\sigma = \sqrt{S}$.
...</p></div><footer class=entry-footer><span title='2023-08-03 00:00:00 +0000 UTC'>August 3, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Robust Extended Kalman Filter update. Part 2: comparison with outlier rejection approach" href=https://nmayorov.github.io/posts/robust_ekf_vs_thresholds/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Robust Extended Kalman Filter update. Part 1: basic theory</h2></header><div class=entry-content><p>When viewed as an optimization problem the Extended Kalman Filter update step can be generalized to incorporate a robust loss function in order to protect against outlier measurements. In this note the initial theoretical development is given.
Introducing a robust loss function In the standard EKF update cost function the measurement residuals appear squared, which is known to be not robust against outliers. We can alleviate this problem by wrapping the measurement residual part with a loss function $\rho$ as follows: $$ E(X) = \frac{1}{2} (X - X^-)^T (P^-)^{-1} (X - X^-) + \frac{1}{2} \rho\left( (h(X) - Z)^T R^{-1} (h(X) - Z) \right) $$ The function $\rho$ must be approximately linear for small arguments (to achieve optimality of Kalman update) and sublinear for large arguments (to be robust agains outlier measurements). Let’s state its properties formally:
...</p></div><footer class=entry-footer><span title='2023-07-13 00:00:00 +0000 UTC'>July 13, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Robust Extended Kalman Filter update. Part 1: basic theory" href=https://nmayorov.github.io/posts/robust_ekf/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Extended Kalman Filter update step as an optimization problem</h2></header><div class=entry-content><p>The Extended Kalman Filter is classically built as an extension of the linear Kalman filter using system and measurement models linearization. In this regard the update step in EKF is naturally done in a single step. The iterated EKF aims to improve the linearization point by doing several update iterations and recomputing measurement Jacobian each time. It’s known to be connected with nonlinear optimization.
In this note I want to derive possible EKF update strategies starting from the optimization viewpoint.
...</p></div><footer class=entry-footer><span title='2023-05-04 00:00:00 +0000 UTC'>May 4, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Extended Kalman Filter update step as an optimization problem" href=https://nmayorov.github.io/posts/ekf_update_optimization/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Heading observability in Inertial Navigation Systems</h2></header><div class=entry-content><p>It’s generally known that the heading angle in Inertial Navigation Systems (INS) is observable when the system undergoes acceleration (including turns at nonzero velocity). However if we look at the “modified error model”, it may seem that merely significantly nonzero constant velocity is sufficient. Here I want to figure out this subject using formal observability criteria and then give it intuitive physical explanation.
INS equations in 2 dimensions To investigate heading observability, a simplified version of INS for a 2-dimensional motion is fully sufficient. The state is described relative to the world frame $n$ by 5 variables:
...</p></div><footer class=entry-footer><span title='2023-04-02 00:00:00 +0000 UTC'>April 2, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Heading observability in Inertial Navigation Systems" href=https://nmayorov.github.io/posts/ins_heading_observability/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Implementation of Kalman correction formulas</h2></header><div class=entry-content><p>This is a short note on my view how to best implement Kalman correction formulas in a programing language.
Basic formulas A vector measurement is linearly related to a state vector with an additive noise: $$ z = H x + v $$ Where $z$ and $H$ are a known vector and matrix and the noise vector $v$ has a known covariance matrix $R$. Thus the measurement model is defined by 3 elements – $z, H, R$.
...</p></div><footer class=entry-footer><span title='2023-01-12 00:00:00 +0000 UTC'>January 12, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Implementation of Kalman correction formulas" href=https://nmayorov.github.io/posts/practical_kalman_correction/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Alternative form of Kalman smoother</h2></header><div class=entry-content><p>In this post (recommended to read beforehand) I’ve shown a derivation of the Kalman smoother as a solution to an optimization problem. The resulting formulas are surprisingly elegant, however their applicability depends on the assumption that apriori filter covariance matrices $P_k^-$ are positive definite and invertible. This assumption might be limiting in practical problems and thus another form of the Kalman smoother is derived here.
Motivating example A singular covariance matrix may arise in the following practical scenario. Imagine that we want to process measurements which relate states at the current and previous epochs – $x_k$ and $x_{k-1}$. A possible example might be processing of distance increments from an odometeter in a navigation algorithm. Such measurements are not directly supported by Kalman filter or smoother algorithms. However we can cast them into the Kalman framework by considering an augmented vector $$ x^a_{k + 1} = \begin{bmatrix} x_{k + 1} \\ x_k \end{bmatrix} $$ The approach is also known as «stochastic cloning».
...</p></div><footer class=entry-footer><span title='2023-01-05 00:00:00 +0000 UTC'>January 5, 2023</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Alternative form of Kalman smoother" href=https://nmayorov.github.io/posts/smoother_alt_form/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>INS error equations</h2></header><div class=entry-content><p>In this note I want to derive Inertial Navigation System (INS) error equations in concise and coherent fashion. This is of course a well known subject, however it’s useful to derive all the equations from scratch and revisit the subject from time to time.
INS state variables and equations for them An Inertial Navigation System computes position, velocity and attitude of a moving object using gyro and accelerometer measurements from an Inertial Measurement Unit (IMU).
...</p></div><footer class=entry-footer><span title='2022-12-20 00:00:00 +0000 UTC'>December 20, 2022</span>&nbsp;·&nbsp;21 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to INS error equations" href=https://nmayorov.github.io/posts/ins_error_equations/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Noisy input in state time propagation: "control" vs. "navigation"</h2></header><div class=entry-content><p>In this note I want to show that there are two possible scenarios how noisy input can influence state time propagation in estimation problems. This is not well articulated in classical literature and may create confusion when applying estimation algorithms to practical systems.
I will illustrate the concept on a simple example. Consider a robot which can move in the direction of its longitudinal axis and rotate. Its state is described by 4 variables (2D case):
...</p></div><footer class=entry-footer><span title='2022-12-10 00:00:00 +0000 UTC'>December 10, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label='post link to Noisy input in state time propagation: "control" vs. "navigation"' href=https://nmayorov.github.io/posts/time_propagation_noise/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://nmayorov.github.io/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://nmayorov.github.io/>Navigating Uncertainty</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>