<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Navigating Uncertainty</title>
<meta name=keywords content><meta name=description content="Posts - Navigating Uncertainty"><meta name=author content="Nikolay Mayorov"><link rel=canonical href=https://nmayorov.github.io/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.a801c217e3c96db9c9df36cb1d2216a9bc5d9fa77b72e2afcdf47fb847f8f015.css integrity="sha256-qAHCF+PJbbnJ3zbLHSIWqbxdn6d7cuKvzfR/uEf48BU=" rel="preload stylesheet" as=style><link rel=icon href=https://nmayorov.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nmayorov.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nmayorov.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://nmayorov.github.io/apple-touch-icon.png><link rel=mask-icon href=https://nmayorov.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://nmayorov.github.io/posts/index.xml><link rel=alternate hreflang=en href=https://nmayorov.github.io/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://nmayorov.github.io/posts/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nmayorov.github.io/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nmayorov.github.io/ accesskey=h title="Navigating Uncertainty (Alt + H)">Navigating Uncertainty</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://nmayorov.github.io/open_source title="Open source"><span>Open source</span></a></li><li><a href=https://nmayorov.github.io/archives title="All posts"><span>All posts</span></a></li><li><a href=https://nmayorov.github.io/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://nmayorov.github.io/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>Strapdown IMU synthesis</h2></header><div class=entry-content><p>Synthesis of strapdown Inertial Measurement Unit (IMU) readings is required for simulation of inertial navigation systems and related algorithms development. Here I want to describe the algorithm of IMU synthesis implemented in pyins, which is probably one of the most useful functions in the library.
Problem formulation The task is to compute strapdown IMU readings from a time series of position and attitude. The following points define the algorithm requirements:...</p></div><footer class=entry-footer><span title='2024-03-03 00:00:00 +0000 UTC'>March 3, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Strapdown IMU synthesis" href=https://nmayorov.github.io/posts/imu_synthesis/></a></article><article class=post-entry><header class=entry-header><h2>Robust Extended Kalman Filter update. Part 2: comparison with outlier rejection approach</h2></header><div class=entry-content><p>Here I compare properties of the robust EKF update algorithm with a classical outlier rejection approach based on normalized innovation checks.
Outlier rejection approach A well known and efficient approach in Kalman filtering is analyzing whether normalized measurement innovations are reasonable. The innovation $$ e = z - H x^- $$ has theoretical covariance $$ S = H P^- H^T + R $$ The quadratic form $e^T S^{-1} e$ is expected to have a $\chi$-squared distribution and its excessively large values indicate a possible outlier, which should be rejected....</p></div><footer class=entry-footer><span title='2023-08-03 00:00:00 +0000 UTC'>August 3, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Robust Extended Kalman Filter update. Part 2: comparison with outlier rejection approach" href=https://nmayorov.github.io/posts/robust_ekf_vs_thresholds/></a></article><article class=post-entry><header class=entry-header><h2>Robust Extended Kalman Filter update. Part 1: basic theory</h2></header><div class=entry-content><p>When viewed as an optimization problem the Extended Kalman Filter update step can be generalized to incorporate a robust loss function in order to protect against outlier measurements. In this note the initial theoretical development is given.
Introducing a robust loss function In the standard EKF update cost function the measurement residuals appear squared, which is known to be not robust against outliers. We can alleviate this problem by wrapping the measurement residual part with a loss function $\rho$ as follows: $$ E(X) = \frac{1}{2} (X - X^-)^T (P^-)^{-1} (X - X^-) + \frac{1}{2} \rho\left( (h(X) - Z)^T R^{-1} (h(X) - Z) \right) $$ The function $\rho$ must be approximately linear for small arguments (to achieve optimality of Kalman update) and sublinear for large arguments (to be robust agains outlier measurements)....</p></div><footer class=entry-footer><span title='2023-07-13 00:00:00 +0000 UTC'>July 13, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Robust Extended Kalman Filter update. Part 1: basic theory" href=https://nmayorov.github.io/posts/robust_ekf/></a></article><article class=post-entry><header class=entry-header><h2>Extended Kalman Filter update step as an optimization problem</h2></header><div class=entry-content><p>The Extended Kalman Filter is classically built as an extension of the linear Kalman filter using system and measurement models linearization. In this regard the update step in EKF is naturally done in a single step. The iterated EKF aims to improve the linearization point by doing several update iterations and recomputing measurement Jacobian each time. It’s known to be connected with nonlinear optimization.
In this note I want to derive possible EKF update strategies starting from the optimization viewpoint....</p></div><footer class=entry-footer><span title='2023-05-04 00:00:00 +0000 UTC'>May 4, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Extended Kalman Filter update step as an optimization problem" href=https://nmayorov.github.io/posts/ekf_update_optimization/></a></article><article class=post-entry><header class=entry-header><h2>Heading observability in Inertial Navigation Systems</h2></header><div class=entry-content><p>It’s generally known that the heading angle in Inertial Navigation Systems (INS) is observable when the system undergoes acceleration (including turns at nonzero velocity). However if we look at the “modified error model”, it may seem that merely significantly nonzero constant velocity is sufficient. Here I want to figure out this subject using formal observability criteria and then give it intuitive physical explanation.
INS equations in 2 dimensions To investigate heading observability, a simplified version of INS for a 2-dimensional motion is fully sufficient....</p></div><footer class=entry-footer><span title='2023-04-02 00:00:00 +0000 UTC'>April 2, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Heading observability in Inertial Navigation Systems" href=https://nmayorov.github.io/posts/ins_heading_observability/></a></article><article class=post-entry><header class=entry-header><h2>Implementation of Kalman correction formulas</h2></header><div class=entry-content><p>This is a short note on my view how to best implement Kalman correction formulas in a programing language.
Basic formulas A vector measurement is linearly related to a state vector with an additive noise: $$ z = H x + v $$ Where $z$ and $H$ are a known vector and matrix and the noise vector $v$ has a known covariance matrix $R$. Thus the measurement model is defined by 3 elements – $z, H, R$....</p></div><footer class=entry-footer><span title='2023-01-12 00:00:00 +0000 UTC'>January 12, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Implementation of Kalman correction formulas" href=https://nmayorov.github.io/posts/practical_kalman_correction/></a></article><article class=post-entry><header class=entry-header><h2>Alternative form of Kalman smoother</h2></header><div class=entry-content><p>In this post (recommended to read beforehand) I’ve shown a derivation of the Kalman smoother as a solution to an optimization problem. The resulting formulas are surprisingly elegant, however their applicability depends on the assumption that apriori filter covariance matrices $P_k^-$ are positive definite and invertible. This assumption might be limiting in practical problems and thus another form of the Kalman smoother is derived here.
Motivating example A singular covariance matrix may arise in the following practical scenario....</p></div><footer class=entry-footer><span title='2023-01-05 00:00:00 +0000 UTC'>January 5, 2023</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Alternative form of Kalman smoother" href=https://nmayorov.github.io/posts/smoother_alt_form/></a></article><article class=post-entry><header class=entry-header><h2>INS error equations</h2></header><div class=entry-content><p>In this note I want to derive Inertial Navigation System (INS) error equations in concise and coherent fashion. This is of course a well known subject, however it’s useful to derive all the equations from scratch and revisit the subject from time to time.
INS state variables and equations for them An Inertial Navigation System computes position, velocity and attitude of a moving object using gyro and accelerometer measurements from an Inertial Measurement Unit (IMU)....</p></div><footer class=entry-footer><span title='2022-12-20 00:00:00 +0000 UTC'>December 20, 2022</span>&nbsp;·&nbsp;21 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to INS error equations" href=https://nmayorov.github.io/posts/ins_error_equations/></a></article><article class=post-entry><header class=entry-header><h2>Noisy input in state time propagation: "control" vs. "navigation"</h2></header><div class=entry-content><p>In this note I want to show that there are two possible scenarios how noisy input can influence state time propagation in estimation problems. This is not well articulated in classical literature and may create confusion when applying estimation algorithms to practical systems.
I will illustrate the concept on a simple example. Consider a robot which can move in the direction of its longitudinal axis and rotate. Its state is described by 4 variables (2D case):...</p></div><footer class=entry-footer><span title='2022-12-10 00:00:00 +0000 UTC'>December 10, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label='post link to Noisy input in state time propagation: "control" vs. "navigation"' href=https://nmayorov.github.io/posts/time_propagation_noise/></a></article><article class=post-entry><header class=entry-header><h2>Example of a nonlinear estimation problem solved by optimization</h2></header><div class=entry-content><p>Here I want to demonstrate how the proposed nonlinear estimation algorithm solves an example estimation problem.
Model formulation As a dynamic system for variable $y$ I consider a nonlinear damped oscillator with an external force $a$: $$ \ddot{y} + 2 \eta \omega \dot{y} (1 + \xi \dot{y}^2) + \omega^2 \sin y = a $$ The difference from the linear model are:
The returning force is changed from $y$ to $\sin y$ – this can be viewed as abandoning the small angle approximation for a gravity pendulum The friction force now nonlinear with an additional factor of $1 + \xi \dot{y}^2$ – the friction increases for high speed Introducing the variables $$ x_1 \coloneqq y \\ x_2 \coloneqq \dot{y} \\ $$ we rewrite it as a first order system $$ \dot{x_1} = x_2 \\ \dot{x_2} = -\omega^2 \sin x_1 - 2 \eta \omega x_2 (1 + \xi x_2^2) + a $$ Introduce discrete time variables $$ x_k \coloneqq x(k \tau) \\ a_k \coloneqq a(k \tau) $$ Applying the first-order integration method we get the following discrete time equation: $$ x_{k + 1} = f(x_k, a_k) \\ \text{with }f(x, a) = \begin{bmatrix} x_1 + \tau x_2 \\ x_2 - \tau (\omega^2 \sin x_1 + 2 \eta \omega x_2 (1 + \xi x_2^2) + a) \end{bmatrix} $$ Let’s introduce the noise sources into it:...</p></div><footer class=entry-footer><span title='2022-12-06 00:00:00 +0000 UTC'>December 6, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Nikolay Mayorov</footer><a class=entry-link aria-label="post link to Example of a nonlinear estimation problem solved by optimization" href=https://nmayorov.github.io/posts/nl_estimation_example/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://nmayorov.github.io/posts/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://nmayorov.github.io/>Navigating Uncertainty</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>